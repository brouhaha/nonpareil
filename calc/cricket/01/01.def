; HP-01 instruction set definition from United States Patent 4,158,285
; Copyright 2004 Eric L. Smith <eric@brouhaha.com>
; $Id$
; Keyed in by Eric Smith on 20-Jan-2004 - any errors are probably mine.

NOP CODE - 000000

*MOD WS				WORD SELECT
	000014				DEFAULT: ENTIRE WORD (DIGITS 0 - 11)
W	000014				ENTIRE WORD (DIGITS 0 - 11)
MS	000024				MANTISSA PLUS SIGN (DIGITS 3 - 11)
M	000004				MANTISSA FIELD (DIGITS 3 - 10)
S	000034				MANTISSA SIGN (DIGIT 11)
X	000010				EXPONENT FIELD (DIGITS 0 - 2)
XS	000030				EXPONENT SIGN (DIGIT 2)
WP	000020				WORD TO POINTER (DIGITS 0 - P)
P	000000				POINTER POSITION ONLY (DIGIT P)

*MOD P1				SET POINTER
0	000300
1	000700
2	001100
3	001300
4	001000
5	000400
6	001500
7	001400
8	000200
9	000600
10	001600
11	000100

*MOD P2				TEST POINTER
0	000300
1	000000
2	001100
3	001300
4	001000
5	000400
6	001500
7	001400
8	000200
9	000600
10	001600
11	000100

*MOD N				LOAD CONSTANT
0	000000
1	000100
2	000200
3	000300
4	000400
5	000500
6	000600
7	000700
8	001000
9	001100
10	001200
.	001200
11	001300
-	001300
12	001400
:	001400
13	001500
14	001600
15	001700
BLANK	001700

*MOD S1				RESET STATUS BANK, TEST STATUS BIT
0	000000

*MOD S2				SET, RESET STATUS BIT (NOT S0)
0	000040
1	000000

*MOD I1				GOROMD BEFORE GOTOX, GOSUBX; NOT BEFORE GOSUB
GOROMD	000064 0 0 6

*MOD I2				GOYES AFTER TEST
GOYES	000003 0 0 2

*MOD I3				GOTOX, GOSUBX, GOKEYS AFTER GOROMD
GOTOX	000003 0 0 2
GOSUBX	000001 0 0 2
GOKEYS	000220    10

*MOD I4				TEST BEFORE GOYES
? S??=	000024 0 0 6
? P#	000054 0 0 6
? A#0	000642 5 5 2
? A>=B	001002 5 5 2
? A>=C	000602 5 5 2
? B=0	001442 5 5 2
? C=0	000002 5 5 2
? C#0	000202 5 5 2

*MOD I5				GOROMD, TEST NOT BEFORE GONC
GOROMD	000064 0 0 6
? S??=	000024 0 0 6
? P#	000054 0 0 6
? A#0	000642 5 5 2
? A>=B	001002 5 5 2
? A>=C	000602 5 5 2
? B=0	001442 5 5 2
? C=0	000002 5 5 2
? C#0	000202 5 5 2

*MOD I6				GOROMD, CARRY NOT BEFORE GOTO
GOROMD	000064 0 0 6
? S??=	000024 0 0 6
? P#	000054 0 0 6
? A#0	000642 5 5 2
? A>=B	001002 5 5 2
? A>=C	000602 5 5 2
? B=0	001442 5 5 2
? C=0	000002 5 5 2
? C#0	000202 5 5 2
A=A+1	001102 5 5 2
A=A-1	001142 5 5 2
A=A+B	001302 5 5 2
A=A-B	001342 5 5 2
A=A+C	000502 5 5 2
A=A-C	000502 5 5 2
C=C+1	000102 5 5 2
C=C-1	000142 5 5 2
C=C+C	000242 5 5 2
C=A+C	000702 5 5 2
C=A-C	000742 5 5 2
C=-C-1	000342 5 5 2
C=-C	000302 5 5 2

*OP				----- ARITHMETIC -----

A=0	001402 WS
A SR	001602 WS
A SL	001642 WS		GOES THROUGH THE ADDER
AB EX	001242 WS		B GOES THROUGH THE ADDER
AC EX	000402 WS
A=C	000402 WS
A=A+1	001102 WS		CARRY
A=A-1	001142 WS		CARRY
A=A+B	001302 WS		CARRY
A=A-B	001342 WS		CARRY
A=A+C	000502 WS		CARRY
A=A-C	000542 WS		CARRY
B SR	001702 WS
B=0	001402 WS
BC EX	001542 WS
B=A	001202 WS
C=0	000042 WS
C SR	001742 WS
C=B	001502 WS		B GOES THROUGH THE ADDER
C=C+1	000102 WS		CARRY
C=C-1	000142 WS		CARRY
C=-C	000302 WS		CARRY
C=-C-1	000342 WS		CARRY
C=C+C	000242 WS		CARRY
C=A+C	000702 WS		CARRY
C=A-C	000742 WS		CARRY
? A#0	000642 WS	I2=A	CARRY, MUST BE FOLLOWED BY GOYES
? A>=B	001002 WS	I2=A	CARRY, MUST BE FOLLOWED BY GOYES
? A>=C	000602 WS	I2=A	CARRY, MUST BE FOLLOWED BY GOYES
? B=0	001442 WS	I2=A	CARRY, MUST BE FOLLOWED BY GOYES
? C=0	000002 WS	I2=A	CARRY, MUST BE FOLLOWED BY GOYES
? C#0	000202 WS	I2=A	CARRY, MUST BE FOLLOWED BY GOYES

				----- PROGRAM CONTROL -----

GOSUB	000001 M 8 2	I1#B	MUST NOT BE PRECEEDED BY GOROMD
GOSUBX	000001 MX 8 2	I1=B	MUST BE PRECEEDED BY GOROMD, RTN TO SEL ROM
GOTO	000003 M 8 2	I6#B	MUST NOT BE PRECEEDED BY GOROMD, CARRY
GOTOX	000003 MX 8 2	I1=B	MUST BE PRECEEDED BY A GOROMD
GOYES	000003 M 8 2	I4=B	MUST BE PRECEEDED BY TEST
GONC	000003 M 8 2	I5#B	MUST NOT BE PRECEEDED BY GOROMD, TEST
GOROM	000040 C 4 6
GOROMD	000064 C 4 6	I3=A	MUST BE FOLLOWED BY GOTOX, GOSUBX, GOKEYS
GOKEYS	000220
RETURN	000520
SLEEP	000620
NOP	000000

				----- LOAD CONSTANT -----

A(P)=	000030	N

				----- POINTER -----

P=	000014	P1
P=P+1	000320
P=P-1	000420
? P#	000054	P2	I2=A	CARRY, MUST BE FOLLOWED BY GOYES

				----- STATUS -----

S1-7=	000020	S1
S8-15=	000120	S1
S1=	000104	S2
S2=	000204	S2
S3=	000304	S2
S4=	000404	S2
S5=	000504	S2
S6=	000604	S2
S7=	000704	S2
S8=	001004	S2
S9=	001104	S2
S10=	001204	S2
S11=	001304	S2
S12=	001404	S2
S13=	001504	S2
S14=	001604	S2
S15=	001704	S2
? S0=	000024	S1	I2=A	CARRY, BUT BE FOLLOWED BY GOYES
? S1=	000124	S1	I2=A	CARRY, BUT BE FOLLOWED BY GOYES
? S2=	000224	S1	I2=A	CARRY, BUT BE FOLLOWED BY GOYES
? S3=	000324	S1	I2=A	CARRY, BUT BE FOLLOWED BY GOYES
? S4=	000424	S1	I2=A	CARRY, BUT BE FOLLOWED BY GOYES
? S5=	000524	S1	I2=A	CARRY, BUT BE FOLLOWED BY GOYES
? S6=	000624	S1	I2=A	CARRY, BUT BE FOLLOWED BY GOYES
? S7=	000724	S1	I2=A	CARRY, BUT BE FOLLOWED BY GOYES
? S8=	001024	S1	I2=A	CARRY, BUT BE FOLLOWED BY GOYES
? S9=	001124	S1	I2=A	CARRY, BUT BE FOLLOWED BY GOYES
? S10=	001224	S1	I2=A	CARRY, BUT BE FOLLOWED BY GOYES
? S11=	001324	S1	I2=A	CARRY, BUT BE FOLLOWED BY GOYES
? S12=	001424	S1	I2=A	CARRY, BUT BE FOLLOWED BY GOYES
? S13=	001524	S1	I2=A	CARRY, BUT BE FOLLOWED BY GOYES
? S14=	001624	S1	I2=A	CARRY, BUT BE FOLLOWED BY GOYES
? S15=	001724	S1	I2=A	CARRY, BUT BE FOLLOWED BY GOYES

				----- DISPLAY AND REGISTER -----

CLRREG	000034			CLEARS A, B, C, D ONLY
C=D	000334
CD EX	000134
C=M	000234
M=C	000434
A(P)=F	001234
F=A(P)	001334
BLINK	001134			DSPOFF RESETS BLINK CONDITION
DSPOFF	001034
DSPON	000734
A=DSP	001734
DSP=A	001374
DSP=CL	000374			CONTINUOUSLY UPDATED
DSP=AL	001174			CONNECTS ARMED INDICATOR ONLY
DSP=SW	000774			CONTINUOUSLY UPDATED

				----- CLOCK -----

ENSCWP	001434			ENABLE ONE SECOND WAKE-UPS
DSSCWP	001534			DISABLE ONE SECOND WAKE-UPS
A=CL	000074			HOLD COUNT
A=AL	001474
A=SW	000574
CL=A	000274			RELEASE COUNT
CLRS=A	000174			RELEASE COUNT, RESET DIVIDER
AL=A	000474			ARMS ALARM
ALTOG	001774
SW=A	000674
SW+	001274			SET STOP WATCH INCREMENT MODE
SW-	001074			SET STOP WATCH DECREMENT MODE
SWSTRT	001574
SWSTOP	001674

				----- DATA STORAGE -----

DSAD=A	001160			CHIP ENABLE: CHIP, REG NUMBER IN 'A' REG EXP
A=DR0	000070
A=DR1	000170
A=DR2	000270
A=DR3	000370
A=DR4	000470
A=DR5	000570
A=DR6	000670
A=DR7	000770
A=DR8	001070
A=DR9	001170
A=DR10	001270
A=DR11	001370
A=DR12	001470
A=DR13	001570
A=DR14	001670
A=DR15	001770
DR0=A	000050
DR1=A	000150
DR2=A	000250
DR3=A	000350
DR4=A	000450
DR5=A	000550
DR6=A	000650
DR7=A	000750
DR8=A	001050
DR9=A	001150
DR10=A	001250
DR11=A	001350
DR12=A	001450
DR13=A	001550
DR14=A	001650
DR15=A	001750

*END
